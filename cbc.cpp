//***************************************************************************************************
//*                                                                                                 *
//*            *@@@@@@@@@@@@@*         *********************************************************    *
//*         @@@~*           *@@@;      * Arquivo: cbc.cpp                                      *    *
//*      *@@*                   @@*    * Autor: João Pedro Melquiades Gomes                    *    *
//*    *@@    *@*            @@;       * Descrição: Implementação da classe CBC                *    *
//*   ;@      @@@@*        :@@0~       *********************************************************    *
//*  ;@         @@@@      @@@S                                                                      *
//* *@           ;@@@*   @@@;                                                                       *
//* @*            *@@@@  *@*        @@@          @@@@    @@@@@@@@@@@   @@@@       @@                *
//* F*              @@@@*           @@@@        @@@@@                  @@@@@*     @@                *
//* s*              @@@@@i          @@*@@      @@@@@@                  @@@@@@@    @@                *
//* @*            *@@@;@@@@:        @@ *@@    @@@ @@@    @@@@@@@@@@    @@@  @@@   @@                * 
//* *@           @@@@*  *@@@@       @@  @@@  @@@  @@@    *********     @@@   @@@* @@                *
//*  @@        *@@@;      @@@@*     @@   @@@@@*   @@@                  @@@     @@@@@                *
//*   :@*     @6@@*        **@@@    @@    *@@b    @@@    @@@@@@@@@@@   @@@      @@@@                *
//*    *@+*   ***            ****   **     **      **    ***********   ***        **                *
//*     *@@@                  *@@;                                                                  *
//*        *+@@@*         *@@@@*   Laboratório de Excelência em microeletrônica do Nordeste         *
//*            *@@@@i@@@i@~*       Universidade Federal de Campina Grande                           * 
//***************************************************************************************************  



#include "cbc.h"



CBC::CBC(uint8_t dt[], uint8_t k[], uint8_t iv[]):ECB(dt, k){
	for(int i = 0; i < 16; i++)
		ivData[i] = iv[i];
}

void CBC::cbcCrypt(){
	for(int i = 0; i < 16; i++)
		data[i] = data[i] ^ ivData[i];

	crypt();
}

void CBC::cbcDecrypt(){
	decrypt();

	for(int i = 0; i < 16; i++)
		cipher[i] = cipher[i] ^ ivData[i];

}